modeltype Ecore uses 'http://www.eclipse.org/emf/2002/Ecore';

transformation intermSimple(in srcModel : Ecore, out dstModel : Ecore);

intermediate class LeafAttribute {
	_name:String;
	_attr:EAttribute;
};

main() {
	var v := srcModel.objects()[EClass]->collect(eAllAttributes->map attr2LeafAttrs('p_'));
	object EClass {name := 'cls'; eStructuralFeatures += v->collect(_attr); }
}

mapping EAttribute::attr2LeafAttrs(in prefix:String) : Sequence(LeafAttribute) {
	init {
		result := Sequence {
			object LeafAttribute {_attr:=object EAttribute{name := prefix+self.name}; _name:=_attr.name;}
		}
	}
}

