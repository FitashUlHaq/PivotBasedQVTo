
modeltype ecore uses "http://www.eclipse.org/emf/2002/Ecore";

transformation ImportedMappingTest();

property INDIRECT_IMPORT_PROP : String = 'ImportedMappingTest::INDIRECT_IMPORT_PROP';

main() {	
}

mapping echoMapping(in element: EModelElement) : ecore::EModelElement {
	init {
		result := element;	
	}
}
 
/**
 Test virtual operations deifned in a single module
*/
mapping testGlobalVirtualMapping(
	element: EAnnotation, named: EEnumLiteral, 
	typed: EOperation, attrib: EStructuralFeature, 
	ref: EReference, param : EParameter) : Tuple(status :Boolean, p : EPackage) {
	
	--just test a local mapping
	
	init {
		var outputs : Sequence(EModelElement) := Sequence { 
			this.echoMapping(element), named, typed, attrib, ref, param	
		};
		  
		var pack := object EPackage {
			name := 'testGlobalVirtualMapping';
			eClassifiers := outputs.globalVirtualMapping(12, Set{ 1 }, Tuple { val = Bag{ false }})->asOrderedSet();			
		};
	
		var resultTag := pack.eClassifiers.name = Sequence {
			'EModelElement::globalVirtualMapping',
			'ENamedElement::globalVirtualMapping',
			'ETypedElement::globalVirtualMapping', -- EOperation
			'EStructuralFeature::globalVirtualMapping', -- EAttribute		
			'EReference::globalVirtualMapping', -- concrete match
			'EParameter::globalVirtualMapping' -- concrete match  	
		};
		
		result := Tuple { status = resultTag, p = pack };				
	}
}

mapping EModelElement::globalVirtualMapping(in arg1 : OclAny, in arg2 : Collection(Real), in arg3: Tuple (val : Collection(OclAny))) : EClass {
	name:='EModelElement::globalVirtualMapping';
}

mapping ENamedElement::globalVirtualMapping(in arg1 : OclAny, in arg2 : Collection(Real), in arg3: Tuple (val : Collection(OclAny))) : EClass {
	name:='ENamedElement::globalVirtualMapping';
}


mapping EReference::globalVirtualMapping(in arg1 : OclAny, in arg2 : Collection(Real), in arg3: Tuple (val : Collection(OclAny))) : EClass {
	name:='EReference::globalVirtualMapping';
}

